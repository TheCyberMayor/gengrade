<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transcript Test - IntellGrade</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="assets/css/style.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h4>Transcript System Test</h4>
                    </div>
                    <div class="card-body">
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <h5>Test Controls</h5>
                                <button class="btn btn-primary me-2" onclick="testTranscriptDisplay()">
                                    <i class="fas fa-eye me-2"></i>Test Display
                                </button>
                                <button class="btn btn-success me-2" onclick="testPDFGeneration()">
                                    <i class="fas fa-file-pdf me-2"></i>Test PDF
                                </button>
                                <button class="btn btn-info" onclick="testPrint()">
                                    <i class="fas fa-print me-2"></i>Test Print
                                </button>
                            </div>
                            <div class="col-md-6">
                                <h5>Status</h5>
                                <div id="testStatus" class="alert alert-info">
                                    Ready to test transcript functionality
                                </div>
                            </div>
                        </div>

                        <div id="transcriptTestArea">
                            <!-- Transcript content will be displayed here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="assets/js/transcript.js"></script>
    
    <script>
        let transcriptManager;

        document.addEventListener('DOMContentLoaded', function() {
            transcriptManager = new TranscriptManager();
            transcriptManager.init();
            updateStatus('Transcript manager initialized successfully', 'success');
        });

        function testTranscriptDisplay() {
            updateStatus('Testing transcript display...', 'info');
            
            const testArea = document.getElementById('transcriptTestArea');
            const student = transcriptManager.getCurrentStudent();
            
            if (!student) {
                updateStatus('No student data available', 'danger');
                return;
            }

            // Create a simplified transcript display
            testArea.innerHTML = `
                <div class="card">
                    <div class="card-header">
                        <h5>Student Transcript Preview</h5>
                    </div>
                    <div class="card-body">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <p><strong>Name:</strong> ${student.name}</p>
                                <p><strong>Student ID:</strong> ${student.studentId}</p>
                                <p><strong>Program:</strong> ${student.program}</p>
                            </div>
                            <div class="col-md-6">
                                <p><strong>Overall GPA:</strong> ${student.overallGPA.toFixed(2)}</p>
                                <p><strong>Semesters:</strong> ${student.semesters.length}</p>
                                <p><strong>Total Credits:</strong> ${calculateTotalCredits(student)}</p>
                            </div>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Semester</th>
                                        <th>GPA</th>
                                        <th>Courses</th>
                                        <th>Credits</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${student.semesters.map(semester => `
                                        <tr>
                                            <td>${semester.semester}</td>
                                            <td><span class="badge bg-success">${semester.gpa.toFixed(2)}</span></td>
                                            <td>${semester.courses.length}</td>
                                            <td>${semester.courses.reduce((sum, course) => sum + course.credits, 0)}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            `;
            
            updateStatus('Transcript display test completed successfully', 'success');
        }

        function testPDFGeneration() {
            updateStatus('Testing PDF generation...', 'info');
            
            if (transcriptManager) {
                transcriptManager.downloadTranscript()
                    .then(() => {
                        updateStatus('PDF generation test completed successfully', 'success');
                    })
                    .catch(error => {
                        updateStatus('PDF generation failed: ' + error.message, 'danger');
                    });
            } else {
                updateStatus('Transcript manager not available', 'danger');
            }
        }

        function testPrint() {
            updateStatus('Testing print functionality...', 'info');
            
            if (transcriptManager) {
                transcriptManager.printTranscript();
                updateStatus('Print test completed - check print dialog', 'success');
            } else {
                updateStatus('Transcript manager not available', 'danger');
            }
        }

        function calculateTotalCredits(student) {
            return student.semesters.reduce((sum, semester) => {
                return sum + semester.courses.reduce((semesterSum, course) => semesterSum + course.credits, 0);
            }, 0);
        }

        function updateStatus(message, type) {
            const statusDiv = document.getElementById('testStatus');
            statusDiv.className = `alert alert-${type}`;
            statusDiv.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'danger' ? 'exclamation-triangle' : 'info-circle'} me-2"></i>
                ${message}
            `;
        }
    </script>
</body>
</html> 